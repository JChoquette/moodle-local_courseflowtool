{"version":3,"file":"ImportTool.min.js","sources":["../src/ImportTool.js"],"sourcesContent":["/**\n * @module     local_courseflowtool/ImportTool\n * @copyright  2025 Jeremie Choquette\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n *\n * This file is part of Moodle - http://moodle.org/\n *\n * Moodle is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Moodle is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/*eslint no-unused-vars: [\"error\", { \"args\": \"none\" }]*/\n\nexport const init = ({sesskey, courseid, json_process_error}) => {\n    // JSON import button event listener\n    document.getElementById('import-button').addEventListener('click', function() {\n        let jsonData = document.getElementById('json-input').value;\n        let useStyle = document.getElementById('courseflow-style').checked ?? false;\n        let associateOutcomes = document.getElementById('associate-outcomes').checked ?? false;\n        fetch(`process_json.php?courseid=${courseid}&sesskey=${sesskey}`, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({\n                json: jsonData,\n                usestyle: useStyle,\n                associateoutcomes: associateOutcomes,\n            })\n        })\n        .then(response => {\n            // eslint-disable-next-line no-console\n            // console.log(response.text());\n            return response.json();\n        })\n        .then(data => {\n            document.getElementById('response').innerHTML = data.message;\n            if(data.redirect){window.location.replace(data.redirect);}\n        })\n        .catch(error => {\n            document.getElementById('response').innerHTML = json_process_error;\n        });\n    });\n    // URL import button event listener\n    document.getElementById('url-import-button').addEventListener('click', function() {\n        let useStyle = document.getElementById('courseflow-style').checked ?? false;\n        let associateOutcomes = document.getElementById('associate-outcomes').checked ?? false;\n        let urlInput = document.getElementById(\"courseflow-url\");\n        let importurl = urlInput?.value || '';\n        fetch(`process_json.php?courseid=${courseid}&sesskey=${sesskey}`, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({\n                usestyle: useStyle,\n                associateoutcomes: associateOutcomes,\n                importurl:importurl,\n            })\n        })\n        .then(response => {\n            // eslint-disable-next-line no-console\n            // console.log(response.text());\n            return response.json();\n        })\n        .then(data => {\n            document.getElementById('response').innerHTML = data.message;\n            if(data.redirect){window.location.replace(data.redirect);}\n        })\n        .catch(error => {\n            document.getElementById('response').innerHTML = json_process_error;\n        });\n    });\n};\n"],"names":["_ref","sesskey","courseid","json_process_error","document","getElementById","addEventListener","jsonData","value","useStyle","checked","associateOutcomes","fetch","method","headers","body","JSON","stringify","json","usestyle","associateoutcomes","then","response","data","innerHTML","message","redirect","window","location","replace","catch","error","urlInput","importurl"],"mappings":"oKAwBoBA,WAACC,QAACA,QAADC,SAAUA,SAAVC,mBAAoBA,yBAErCC,SAASC,eAAe,iBAAiBC,iBAAiB,SAAS,gEAC3DC,SAAWH,SAASC,eAAe,cAAcG,MACjDC,uCAAWL,SAASC,eAAe,oBAAoBK,gEACvDC,iDAAoBP,SAASC,eAAe,sBAAsBK,kEACtEE,0CAAmCV,6BAAoBD,SAAW,CAC9DY,OAAQ,OACRC,QAAS,gBACW,oBAEpBC,KAAMC,KAAKC,UAAU,CACjBC,KAAMX,SACNY,SAAUV,SACVW,kBAAmBT,sBAG1BU,MAAKC,UAGKA,SAASJ,SAEnBG,MAAKE,OACFnB,SAASC,eAAe,YAAYmB,UAAYD,KAAKE,QAClDF,KAAKG,UAAUC,OAAOC,SAASC,QAAQN,KAAKG,aAElDI,OAAMC,QACH3B,SAASC,eAAe,YAAYmB,UAAYrB,yBAIxDC,SAASC,eAAe,qBAAqBC,iBAAiB,SAAS,iEAC/DG,wCAAWL,SAASC,eAAe,oBAAoBK,kEACvDC,iDAAoBP,SAASC,eAAe,sBAAsBK,kEAClEsB,SAAW5B,SAASC,eAAe,kBACnC4B,WAAYD,MAAAA,gBAAAA,SAAUxB,QAAS,GACnCI,0CAAmCV,6BAAoBD,SAAW,CAC9DY,OAAQ,OACRC,QAAS,gBACW,oBAEpBC,KAAMC,KAAKC,UAAU,CACjBE,SAAUV,SACVW,kBAAmBT,kBACnBsB,UAAUA,cAGjBZ,MAAKC,UAGKA,SAASJ,SAEnBG,MAAKE,OACFnB,SAASC,eAAe,YAAYmB,UAAYD,KAAKE,QAClDF,KAAKG,UAAUC,OAAOC,SAASC,QAAQN,KAAKG,aAElDI,OAAMC,QACH3B,SAASC,eAAe,YAAYmB,UAAYrB"}