{"version":3,"file":"PreviewImport.min.js","sources":["../src/PreviewImport.js"],"sourcesContent":["/**\n * @module     local_courseflowtool/PreviewImport\n * @copyright  2025 Jeremie Choquette\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n *\n * This file is part of Moodle - http://moodle.org/\n *\n * Moodle is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Moodle is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/*eslint no-unused-vars: [\"error\", { \"args\": \"none\" }]*/\n//TODO: replace strings passing with get_string()\nexport const init = ({sesskey, courseid, error_finalize,error_generic}) => {\n    document.getElementById('confirm-import').addEventListener('click', function() {\n        let formData = new FormData(document.getElementById('import-form'));\n\n        fetch(`finalize_import.php?courseid=${courseid}&sesskey=${sesskey}`, {\n            method: 'POST',\n            body: formData\n        })\n        .then(response => {\n            // eslint-disable-next-line no-console\n            // console.log(response.text());\n            return response.json();\n        })\n        .then(data => {\n            if (data.status === 'success') {\n                document.getElementById(\"import-form\").innerHTML = `<p>${data.message}</p>`;\n            } else {\n                document.getElementById(\"import-form\").innerHTML = `<p>${error_generic}: ${data.message}</p>`;\n            }\n        })\n        .catch(error => {\n            document.getElementById(\"import-form\").innerHTML = `<p>${error_finalize}.</p>`;\n        });\n    });\n};\n"],"names":["_ref","sesskey","courseid","error_finalize","error_generic","document","getElementById","addEventListener","formData","FormData","fetch","method","body","then","response","json","data","status","innerHTML","message","catch","error"],"mappings":"uKAwBoBA,WAACC,QAACA,QAADC,SAAUA,SAAVC,eAAoBA,eAApBC,cAAmCA,oBACpDC,SAASC,eAAe,kBAAkBC,iBAAiB,SAAS,eAC5DC,SAAW,IAAIC,SAASJ,SAASC,eAAe,gBAEpDI,6CAAsCR,6BAAoBD,SAAW,CACjEU,OAAQ,OACRC,KAAMJ,WAETK,MAAKC,UAGKA,SAASC,SAEnBF,MAAKG,OACkB,YAAhBA,KAAKC,OACLZ,SAASC,eAAe,eAAeY,uBAAkBF,KAAKG,gBAE9Dd,SAASC,eAAe,eAAeY,uBAAkBd,2BAAkBY,KAAKG,mBAGvFC,OAAMC,QACHhB,SAASC,eAAe,eAAeY,uBAAkBf"}